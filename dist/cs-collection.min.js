!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("Immutable"),require("PubSub")):"function"==typeof define&&define.amd?define(["Immutable","PubSub"],t):"object"==typeof exports?exports.CsCollection=t(require("Immutable"),require("PubSub")):e.CsCollection=t(e.Immutable,e.PubSub)}(this,function(e,t){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(4),c=r(u),l=function(){function e(t,n,r){if(o(this,e),!t||"object"!=("undefined"==typeof t?"undefined":i(t)))return void console.error("没有配置或者配置错误");window.collectionConfig=t,window.collectionI18n=n||"en","string"==typeof r?window.collectionMock=JSON.parse(r):window.collectionMock=r||{millis:34,code:"SUCCESS",message:"操作成功",entity:""};var a=window.localStorage.getItem("oldUrl")||"",u=!1;a.includes("mock")!=location.href.includes("mock")&&(u=!0,window.localStorage.setItem("oldUrl",location.href)),u&&window.localStorage.setItem("db","{}"),window.db={};var l=window.localStorage.getItem("db")||"{}";l=JSON.parse(l);for(var f in t){var s=!1;for(var d in l)d===f&&(s=!0);var y=[];s&&(y=l[f].items),window.db[f]=new c["default"](f,y)}}return a(e,[{key:"setCollectionI18n",value:function(e){window.collectionI18n=e||"en"}}]),e}();t["default"]=l},function(t,n){t.exports=e},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(1),f=n(9),s=r(f),d=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),c(t,null,[{key:"getList",value:function(e){return Array.isArray(e)?(0,l.List)(e):l.List.of()}},{key:"isMap",value:function(e){return l.Map.isMap(e)}},{key:"isList",value:function(e){return l.List.isList(e)}},{key:"getParamObj",value:function(e,n){var r={};if("object"==("undefined"==typeof e?"undefined":u(e)))r=n[1]?t.withoutKeyObj(e,n[0]):n[0]?t.getKeyObj(e,n[0]):e;else{if("string"!=typeof e)return!1;r=e}return!r||$.isEmptyObject(r)?(console.error("参数为空"),!1):r}},{key:"setLocalData",value:function(e,t){window.db[e].items=t,window.localStorage.setItem("db",JSON.stringify(window.db))}},{key:"updateData",value:function(e,n,r){var o=window.db&&window.db[e].items;if(o&&o.size>0){var i=function(){var i=(0,l.List)(),a=(0,l.List)();return o.forEach(function(e,t){if(e[r]==n[r]){var u;!function(){var r=(0,l.Map)(e);for(u in n)r.map(function(e,t){t==u&&(a=r.set(u,n[u]))});var c=a.toObject();c.cacheTime=(new Date).getTime(),i=o.set(t,c)}()}}),i&&i.size>0?t.setLocalData(e,i):console.error("更改的数据不存在！"),{v:a.toObject()}}();if("object"===("undefined"==typeof i?"undefined":u(i)))return i.v}else console.error("更改的数据不存在！")}},{key:"removeData",value:function(e,n,r){var o=window.db&&window.db[e].items;if(o&&o.size>0){var i=(0,l.List)(),a=!1,u=void 0;return o.forEach(function(e,t){e[r]==n&&(a=!0,i=o.remove(t),u=e)}),a?t.setLocalData(e,i):console.error("删除的数据不存在！"),u}console.error("删除的数据不存在！")}},{key:"getKeyObj",value:function(e,n){if(e&&!t.isEmpty(e)&&n){var r={},o=[];n.constructor==String?o.push(n):n.constructor==Array&&(o=n);for(var i=0;i<o.length;i++){var a=o[i];l.Map.isMap(e)?void 0!=e.get(a)&&(r[a]=e.get(a)):e.constructor==Object?void 0!=e[a]&&(r[a]=e[a]):e.constructor==Array&&void 0!=e[0][a]&&(r[a]=e[0][a])}return r}}},{key:"getListKeyObj",value:function(e,n){if(e&&n){for(var r=[],o=0;o<e.length;o++){var i=this.getKeyObj(e[o],n);t.isEmpty(i)||r.push(i)}return r}}},{key:"filterListKey",value:function(e,n){if(e&&!t.isEmpty(e)&&n)return l.List.isList(e)?this.filterMapListKey(e,n):e.constructor==Array?this.filterMapListKey((0,l.List)(e),n):void 0}},{key:"filterMapListKey",value:function(e,t){if(e&&t&&l.List.isList(e)){var n=(0,l.Map)(t),r=e.filter(function(e){var t=!0;return n.map(function(n,r){n!=(0,l.Map)(e).get(r)&&(t=!1)}),t});return r}}},{key:"withoutKeyObj",value:function(e,n){if(e&&!t.isEmpty(e)&&n){var r;if(l.Map.isMap(e))r=this.withoutMapKeyObj(e,n);else if(e.constructor==Object){var o=(0,l.Map)(e);r=this.withoutMapKeyObj(o,n)}else if(e.constructor==Array){r=[];for(var i=0;i<e.length;i++){var a=this.withoutMapKeyObj((0,l.Map)(e[i]),n);r.push(a)}}return r}}},{key:"withoutMapKeyObj",value:function(e,t){if(e&&t&&l.Map.isMap(e)){var n;if(t.constructor==String)n=e.filterNot(function(e,n){return t==n});else if(t.constructor==Array){var r=(0,l.List)(t);n=e.filterNot(function(e,t){return r.includes(t)})}return n.toObject()}}}]),t}(s["default"]);t["default"]=d},function(e,n){e.exports=t},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(6),c=r(u),l=n(2),f=r(l),s=n(7),d=r(s),y=n(3),p=r(y),m=function(){function e(t,n){o(this,e),this.id=f["default"].uuid(),this.colName=t,this.items=f["default"].getList(n)}return a(e,[{key:"pubsub",value:function(e,t){p["default"].subscribe(this.pubsubKey(e),t)}},{key:"unsubscribe",value:function(e){p["default"].unsubscribe(this.pubsubKey(e))}},{key:"pubsubKey",value:function(e){return"collection."+this.colName+"."+e+"."+this.id}},{key:"findOne",value:function(t){e.clearCacheData(this.colName,"findOne");var n=c["default"].findOne(this.colName,t,this.pubsubKey("findOne"));p["default"].publish(this.pubsubKey("findOne"),n.nowItems)}},{key:"find",value:function(t,n){if(!t||"object"==!("undefined"==typeof t?"undefined":i(t)))return!1;var r={};for(var o in t){var a=t[o];if("object"!=("undefined"==typeof a?"undefined":i(a)))r[o]=a;else for(var u in a){var l=a[u];if(0!=u.indexOf("$"))return!1;var f=u;try{var s=d["default"][f](l);if(!s)return!1;r[o]=s}catch(y){return!1}}}e.clearCacheData(this.colName,"find");var m=c["default"].find(this.colName,t,this.pubsubKey("find"));p["default"].publish(this.pubsubKey("find"),m.nowItems)}},{key:"insert",value:function(t){e.clearCacheData(this.colName,"insert");for(var n=c["default"].getRequestNum(this.colName),r=0;r<n;r++){var o=c["default"].insert(this.colName,t);p["default"].publish(this.pubsubKey("insert"),o.nowItems)}}},{key:"update",value:function(t){var n=this;if(e.clearCacheData(this.colName,"update"),!c["default"].isMock)return c["default"].update(this.colName,t).then(function(e){p["default"].publish(n.pubsubKey("update"),e.nowItems)}.bind(this));var r=c["default"].update(this.colName,t);if(r){if("function"==typeof r.then)return r.then(function(e){p["default"].publish(n.pubsubKey("update"),e.nowItems)}.bind(this));p["default"].publish(this.pubsubKey("update"),r.nowItems)}}},{key:"remove",value:function(t){e.clearCacheData(this.colName,"remove");for(var n=c["default"].getRequestNum(this.colName),r=0;r<n;r++){var o=c["default"].remove(this.colName,t);p["default"].publish(this.pubsubKey("remove"),o.nowItems)}}}],[{key:"clearCacheData",value:function(e,t){var n=c["default"].getCacheTimeOut(e),r=(new Date).getTime(),o=window.db&&window.db[e].items.toArray(),i=[];for(var a in o){var u=o[a].cacheTime;n!=-1&&r-n>u&&i.push(a)}i=i.reverse();for(var a=0;a<i.length;a++)o.splice(i[a],1);f["default"].setLocalData(e,f["default"].getList(o))}}]),e}();t["default"]=m},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(8),l=r(c),f=function(){function e(){i(this,e)}return u(e,null,[{key:"getKeyItems",value:function(e){var t=[];for(var n in e)t.push(n);return t}},{key:"mockUUID",value:function(t,n,r){if("object"===("undefined"==typeof t?"undefined":a(t))){var o=e.getKeyItems(t)[0],i=t[o].length||32,u="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678";return t[o]=e.getRandomString(i,u),n[r]=t,n}}},{key:"createMockContent",value:function(t,n){var r=JSON.parse(JSON.stringify(t));if("object"===("undefined"==typeof r?"undefined":a(r))){var i=function(){var t=e.getKeyItems(r),i=l["default"][e.mockLevel]||l["default"][e.level_1];return t.forEach(function(t,u){if($.isArray(r[t])){var c=[],l=e.getRandomlength(i.array);if("object"===a(r[t][0]))for(var f=0;f<l;f++){var s={};for(var d in r[t][0])s=$.extend(s,o({},d,e.getItemValue(n[d],i)));c.push(s)}else for(var f=0;f<l;f++)c.push(e.getItemValue(r[t][0],i));r[t]=c}else r[t]=e.getItemValue(n[t],i)}),{v:r}}();if("object"===("undefined"==typeof i?"undefined":a(i)))return i.v}}},{key:"getItemValue",value:function(t,n){var r="";if("string"===t){var o=window.collectionI18n;r=e.getSpecialItem(o,n[o])}else if("int"===t)r=e.getSpecialItem("int",n["int"]);else if("money"===t){var i=e.getSpecialItem("int",n["int"]);r=parseFloat(i/100).toFixed(2)}else"time"===t&&(r=(new Date).getTime());return r}},{key:"getRandomlength",value:function(e){if(e&&2==e.length){var t=e[1]-e[0]+1,n=Math.random();return e[0]+Math.round(n*t)}}},{key:"getRandomString",value:function(e,t){for(var n=t.length,r="",o=0;o<e;o++)r+=t.charAt(Math.floor(Math.random()*n));return r}},{key:"getSpecialItem",value:function(t,n){if(t&&n){if("int"==t){var r=e.getRandomlength(n),o="0123456789";return parseInt(e.getRandomString(r,o))}if("en"==t){var i=e.getRandomlength(n),a="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678";return e.getRandomString(i,a)}if("zh"==t){for(var u=new Array,c=e.getRandomlength(n),l=0;l<c;l++)u[l]=Math.round(20927*Math.random())+19968;var f=new Array;for(var l in u)f.push(String.fromCodePoint(u[l]));return f.join("")}}}}]),e}();f.level_1="level_1",f.level_2="level_2",f.level_3="level_3",f.mockLevel=function(){var e=location.href;if(e.includes("mock")){var t=e.indexOf("mock")+5,n=e.indexOf("&",t);return n<0&&(n=e.length),e.substring(t,n)||f.level_1}}(),t["default"]=f},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(5),c=r(u),l=n(2),f=r(l),s=n(1),d=n(3),y=r(d),p=function(){function e(){i(this,e)}return a(e,null,[{key:"isMockUrl",value:function(e,t){var n=window.collectionConfig[e],r=n&&n[t],o=r&&r.mockUrl||"";return o}},{key:"getStoreParam",value:function(e,t){var n=window.collectionConfig[e],r=n&&n[t],o=r&&r.storeParam||"entity";return o}},{key:"mock",value:function(t,n,r){var o=window.collectionConfig[t],i=o&&o[n],a=i&&i["return"],u=o&&o.entity&&o.entity.fields,l=i&&i.structure||{millis:32,code:"SUCCESS",message:"操作成功",entity:""},f=e.getStoreParam(t,n),s=e.getPrimaryKey(t);if(!a||$.isEmptyObject(a)){var d=e.isMockUrl(t,n);return d?d:window.collectionMock}if(a.hasOwnProperty(s)&&1==e.getObjLength(a))return c["default"].mockUUID(a,l,f);if(a&&u){var y=c["default"].createMockContent(a,u);return l[f]=y,l}}},{key:"getObjLength",value:function(e){var t=0;for(var n in e)t++;return t}},{key:"getUrl",value:function(e,t,n){var r=window.collectionConfig[e],o=r&&r[t];return o&&o.getUrl(n)}},{key:"getReturnChain",value:function(e,t){var n=window.collectionConfig[e],r=n&&n[t];return r&&r.returnChain}},{key:"getCacheTimeOut",value:function(e){var t=window.collectionConfig[e],n=t&&t.entity;return n&&n.cacheTimeOut}},{key:"getRequestNum",value:function(e){var t=window.collectionConfig[e],n=t&&t.entity;return n&&n.requestNum}},{key:"getPrimaryKey",value:function(e){var t=window.collectionConfig[e],n=t&&t.entity;return n&&n.primaryKey}},{key:"getParamValue",value:function(e,t){if(!e||!t)return!1;var n=f["default"].getKeyObj(e,t);return n?n[t]:(console.error("找不到该key值"),!1)}},{key:"getPrimaryKeyValue",value:function(t,n){var r="";if("string"==typeof n)r=n;else{var o=e.getPrimaryKey(t);r=e.getParamValue(n,o)}return r?r:(console.error("找不到主键值"),!1)}},{key:"getNowdbData",value:function(t,n,r,o,i){var a=[],u=e.getStoreParam(t,r),c=o[u];if(n){var l=n.split(".");a=o;for(var f=0;f<l.length;f++)a=a[l[f]]}else if(c[i])a=c;else for(var f in c)c[f]&&c[f].length>0&&(a=c[f]);return"findOne"==r&&a&&a.length>0&&(a=a[0]),a}},{key:"isInsert",value:function(e,t,n,r){var o=!0,i=window.db&&window.db[e]&&window.db[e].items,a=(0,s.List)();return i&&i.size>0&&i.forEach(function(e,u){if(e[r]==n[r]&&(o=!1,"findOne"==t)){var c=$.extend({},e,n);a=i.set(u,c)}}),"findOne"==t?$.extend({isInsert:o},{extend:a}):o}},{key:"getDataKey",value:function(e,t){var n=window.collectionConfig[e];return n&&n[t]&&n[t].include?[n&&n[t]&&n[t].include,!1]:n&&n[t]&&n[t].exclusive?[n&&n[t]&&n[t].exclusive,!0]:["",!1]}},{key:"findOne",value:function(t,n,r){var o="findOne",i=e.getPrimaryKey(t),a=(e.getPrimaryKeyValue(t,n),window.db&&window.db[t]&&window.db[t].items),u=a.first()&&a.first().projectId;a&&a.size>0&&a.forEach(function(e,t){e[i]==u&&y["default"].publish(r,(0,s.Map)(e))});var c={millis:32,code:"SUCCESS",message:"操作成功",entity:{serviceResultCode:null,accessToken:null,allProjectNum:null,joinNum:1,closeNum:0,projectInfoList:[{projectId:"8c8c8ca956e00caa0156e8be040400dd",projectName:"来，跟我一起说：耶~",projectManager:"沈佳芳2233",projectManagerIcon:"https://file.newtouch.com/yangyang/131d4e16-6509-47d0-a46b-21c39480b89d.png",projectStatus:"14001",projectImportanceLevel:"41001",projectIcon:"https://file.newtouch.com/yangyang/item_logo_4.png",projectTagList:[],members:1,projectManagerLoginName:"shenjiafang",projectNameSpace:"sjzmdqkk",projectNameForShirt:"sjzmd",projectCode:"wyqkk",commonFlag:"16001"}],closeProjectInfoList:[],commonProjectInfoList:null,regularProjectInfoList:null}};if("SUCCESS"===c.code)return e.setFindOneData(t,o,c)}},{key:"setFindOneData",value:function(t,n,r){var o=e.getReturnChain(t,n),i=e.getPrimaryKey(t),a=e.getNowdbData(t,o,n,r,i);if(!a)return void console.error(t+"返回链"+o+"，配置有误！");a.cacheTime=(new Date).getTime();var u=e.isInsert(t,n,a,i),c=window.db&&window.db[t]&&window.db[t].items;return u.isInsert&&c&&f["default"].setLocalData(t,window.db[t].items.push(a)),!u.isInsert&&c&&f["default"].setLocalData(t,u.extend),r.nowItems=(0,s.Map)(a),r}},{key:"find",value:function(t,n,r){var o="find",i=window.db&&window.db[t]&&window.db[t].items,a=f["default"].filterListKey(i,n);a&&y["default"].publish(r,a);var u={millis:40,code:"SUCCESS",message:"操作成功",entity:{serviceResultCode:null,accessToken:null,allProjectNum:null,joinNum:3,closeNum:0,projectInfoList:[{projectId:"8c8c8ca9543dbb2901544b98df3d0963",projectName:"莫道芳时易度，朝暮1",projectManager:"沈佳芳",projectManagerIcon:"https://file.newtouch.com/yangyang/131d4e16-6509-47d0-a46b-21c39480b89d.png",projectStatus:"14001",projectImportanceLevel:"41001",projectIcon:"https://file.newtouch.com/yangyang/item_logo_4.png",projectTagList:[],members:1,projectManagerLoginName:"shenjiafang",projectNameSpace:"test0425G30",projectNameForShirt:"test",projectCode:"test",commonFlag:"16001"},{projectId:"8c8c8ca95429546201542d0888bc028d",projectName:"何处几叶萧萧雨1",projectManager:"沈佳芳",projectManagerIcon:"https://file.newtouch.com/yangyang/131d4e16-6509-47d0-a46b-21c39480b89d.png",projectStatus:"14001",projectImportanceLevel:"41001",projectIcon:"https://file.newtouch.com/yangyang/item_logo_4.png",projectTagList:[],members:1,projectManagerLoginName:"shenjiafang",projectNameSpace:"123456jpg",projectNameForShirt:"12",projectCode:"123",commonFlag:"16001"}],closeProjectInfoList:[],commonProjectInfoList:null,regularProjectInfoList:null}};if("SUCCESS"===u.code)return e.setFindData(t,o,u)}},{key:"setFindData",value:function(t,n,r){var o=e.getReturnChain(t,n),i=e.getPrimaryKey(t),a=e.getNowdbData(t,o,n,r,i);if(!a)return void console.error(t+"返回链"+o+"，配置有误！");var u=window.db&&window.db[t]&&window.db[t].items;if(u&&u.size>0){var c=(0,s.List)();for(var l in a){var d=!0;u=c.size>0?c:u,u.forEach(function(e,t){a[l].cacheTime=(new Date).getTime(),e[i]==a[l][i]&&(d=!1,c=u.set(t,a[l]))}),d?f["default"].setLocalData(t,window.db[t].items.push(a[l])):f["default"].setLocalData(t,c)}}else if(u)for(var y in a)a[y].cacheTime=(new Date).getTime(),f["default"].setLocalData(t,window.db[t].items.push(a[y]));return r.nowItems=(0,s.List)(a),r}},{key:"insert",value:function(t,n){var r="insert",o=e.getDataKey(t,r),i=f["default"].getParamObj(n,o);if(e.isMock){var a=e.mock(t,r,n);return"string"==typeof a?$.getJSON(a,null,function(n){e.setInsertData(t,r,n,i)}):e.setInsertData(t,r,a,i)}return $.post(e.getUrl(t,r,n),i,function(n){"SUCCESS"===n.code&&e.setInsertData(t,r,n,i)})}},{key:"setInsertData",value:function(t,n,r,i){var a=e.getPrimaryKey(t),u=e.getStoreParam(t,n),c=r[u],l=e.isInsert(t,n,c,a);if(l){var f=$.extend({cacheTime:(new Date).getTime()},i,o({},a,c[a])),d=window.db&&window.db[t]&&window.db[t].items;return d&&(window.db[t].items=window.db[t].items.push(f),window.localStorage.setItem("db",JSON.stringify(window.db))),r.nowItems=(0,s.Map)(f),r}console.error("已存在此数据，不能重复新建！")}},{key:"update",value:function(t,n){var r="update";if(e.isMock){var o=e.mock(t,r,n);return"string"==typeof o?$.getJSON(o,null,function(o){e.setUpdateData(t,r,o,n)}):e.setUpdateData(t,r,o,n)}var i=e.getDataKey(t,r),a=f["default"].getParamObj(n,i),u=e.getPrimaryKeyValue(t,n);return $.put(e.getUrl(t,r,u),a,function(o){"SUCCESS"===o.code&&e.setUpdateData(t,r,o,n)})}},{key:"setUpdateData",value:function(t,n,r,o){var i=e.getPrimaryKey(t),a=e.getStoreParam(t,n),u=r[a];return u&&u.length>0?(r.nowItems=(0,s.Map)(f["default"].updateData(t,u,i)),r):(r.nowItems=(0,s.Map)(f["default"].updateData(t,o,i)),r)}},{key:"remove",value:function(t,n){var r="remove",o=e.getPrimaryKey(t),i=e.getPrimaryKeyValue(t,n);if(e.isMock){var a=e.mock(t,r,n);return"string"==typeof a?$.getJSON(a,null,function(e){e.nowItems=(0,s.Map)(f["default"].removeData(t,i,o))}):(a.nowItems=(0,s.Map)(f["default"].removeData(t,i,o)),a)}return $["delete"](e.getUrl(t,r,i),null,function(e){"SUCCESS"===e.code&&(e.nowItems=(0,s.Map)(f["default"].removeData(t,i,o)))})}}]),e}();p.initJquery=function(){$.ajaxSetup({cache:!1}),$(document).ajaxSend(function(e,t,n){}),$(document).ajaxSuccess(function(e,t,n){}),$(document).ajaxError(function(e,t,n,r){}),jQuery.each(["put","delete"],function(e,t){jQuery[t]=function(e,n,r,o){return jQuery.isFunction(n)&&(o=o||r||"json",r=n,n=void 0),jQuery.ajax({url:e,type:t,dataType:o,data:n,success:r})}})}(),p.isMock=function(){var e=!1,t=location.href;return t.includes("mock")&&(e=!0),e}(),t["default"]=p},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(){n(this,e)}return r(e,null,[{key:"$in",value:function(e){return!!Array.isArray(e)&&e.toString()}}]),e}();t["default"]=o},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]={level_1:{en:[5,50],zh:[1,20],"int":[1,10],array:[0,20]},level_2:{en:[50,100],zh:[20,80],"int":[10,20],array:[20,80]},level_3:{en:[100,200],zh:[80,150],"int":[20,100],array:[80,150]}}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(1),u=function(){function e(){r(this,e)}return i(e,null,[{key:"pushPollFuns",value:function(t){var n=t;"object"===("undefined"==typeof t?"undefined":o(t))&&(n=t.func),"function"==typeof n&&e.pollFuns.push(t)}},{key:"getKey",value:function(t){var n=(t||"key")+"_";return e.key=e.key+1,n+e.key}},{key:"uuid",value:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,n="x"==e?t:3&t|8;return n.toString(16)})}},{key:"isEmpty",value:function(e){if(!e)return!0;if(a.List.isList(e)||a.Map.isMap(e))return!(e.size>1);if(this.isArray(e))return 0==e.length;if(this.isObject(e)){for(var t in e)return!1;return!0}return!1}},{key:"isObject",value:function(e){var t="undefined"==typeof e?"undefined":o(e);return"function"===t||"object"===t&&!!e}},{key:"isArray",value:function(e){return Array.isArray(e)||"[object Array]"===toString.call(e)}}]),e}();u.pollFuns=[],u.poll=function(){setInterval(function(){for(var e in u.pollFuns){var t=u.pollFuns[e];"function"==typeof t?t():(t.cur=(t.cur||t.delay)-1,t.cur<1&&("function"==typeof t.func&&t.func(),t.cur=t.delay))}},1e3)}(),u.key=0,t["default"]=u}])});