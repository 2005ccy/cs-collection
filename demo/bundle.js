!function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(15),l=r(c),f=n(16),s=n(6),d=r(s),y=n(4),p=r(y),m=n(3),b=r(m),v=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={items:[]},n}return u(t,e),a(t,[{key:"handleQuery",value:function(){var e=window.db&&window.db.project;e.findOne({projectId:"8c8c8ca956e00caa0156e8be040400dc"}),console.log(this.state+"---"),console.log(window.localStorage.getItem("db"))}},{key:"handleQueryMore",value:function(){var e=window.db&&window.db.project;e.find({searchStr:"1"}),console.log(window.localStorage.getItem("db"))}},{key:"handleAdd",value:function(){var e=window.db&&window.db.project;e.insert({projectName:"云澹澹，水悠悠",projectNameShort:"sjzmd",projectCode:"wyqkk",projectNameSpace:"sjzmdqkk",projectDesc:"",commonFlag:"16001",fileListStr:{inFile:[{fileName:"item_logo_4.png",fileType:"60100",sysDefault:"0"}]},importanceLevel:"41001",addTagName:{addTagList:[]}}),console.log(window.localStorage.getItem("db"))}},{key:"handleUpdate",value:function(){var e=window.db&&window.db.project;e.update({projectId:"8c8c8ca956e00caa0156e8be040400dc",projectName:"云澹澹，水悠悠，一声横笛锁空楼"}),console.log(window.localStorage.getItem("db"))}},{key:"handleDetele",value:function(){var e=window.db&&window.db.project;e.remove({projectId:"8c8c8ca956e00caa0156e8be040400dc"}),console.log(window.localStorage.getItem("db"))}},{key:"loginOut",value:function(){window.location.href="http://www.baidu.com";var e=window.db&&window.db.project;e.unsubscribe("findOne"),e.unsubscribe("find"),e.unsubscribe("insert"),e.unsubscribe("update"),e.unsubscribe("remove")}},{key:"render",value:function(){return l["default"].createElement("div",null,l["default"].createElement("div",null,l["default"].createElement("input",null),l["default"].createElement("button",{onClick:this.handleQuery.bind(this)},"查询"),l["default"].createElement("button",{onClick:this.handleQueryMore},"多个查询"),l["default"].createElement("button",{onClick:this.handleAdd},"新建"),l["default"].createElement("button",{onClick:this.handleUpdate},"更改"),l["default"].createElement("button",{onClick:this.handleDetele},"删除"),l["default"].createElement("button",{onClick:this.loginOut},"跳往百度")),l["default"].createElement("br",null),l["default"].createElement("div",null,l["default"].createElement("table",{width:"100%"},l["default"].createElement("thead",null,l["default"].createElement("tr",null,l["default"].createElement("th",{width:"30%"},"项目编号"),l["default"].createElement("th",{width:"30%"},"项目名称"),l["default"].createElement("th",{width:"20%"},"项目经理"),l["default"].createElement("th",{width:"20%"},"项目图片"))),l["default"].createElement("tbody",null,l["default"].createElement("tr",null,l["default"].createElement("td",null),l["default"].createElement("td",null),l["default"].createElement("td",null),l["default"].createElement("td",null))))))}}]),t}(l["default"].Component);v.getPubsub=function(e,t){var n=(new b["default"](p["default"],"en",'{"time": 34,"code": "SUCCESS","message": "操作成功","entity": ""}'),window.db&&window.db.project);n.pubsub("findOne",function(e,t){console.log("findOne ---------- "+JSON.stringify(t)+" ++++++++++ "+d["default"].isMap(t))}),n.pubsub("find",function(e,t){console.log("find ---------- "+JSON.stringify(t)+" ++++++++++ "+d["default"].isList(t))}),n.pubsub("insert",function(e,t){console.log("insert ---------- "+JSON.stringify(t)+" ++++++++++ "+d["default"].isMap(t))}),n.pubsub("update",function(e,t){console.log("update ---------- "+JSON.stringify(t)+" ++++++++++ "+d["default"].isMap(t))}),n.pubsub("remove",function(e,t){console.log("remove ---------- "+JSON.stringify(t)+" ++++++++++ "+d["default"].isMap(t))})}(),(0,f.render)(l["default"].createElement(v,null),document.getElementById("index-container"))},function(e,t){e.exports=Immutable},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":a(t))&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":a(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(t,"__esModule",{value:!0});var c="function"==typeof Symbol&&"symbol"===a(Symbol.iterator)?function(e){return"undefined"==typeof e?"undefined":a(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":"undefined"==typeof e?"undefined":a(e)},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),f=n(1),s=n(12),d=r(s),y=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u(t,e),l(t,null,[{key:"getList",value:function(e){return Array.isArray(e)?(0,f.List)(e):f.List.of()}},{key:"isMap",value:function(e){return f.Map.isMap(e)}},{key:"isList",value:function(e){return f.List.isList(e)}},{key:"getParamObj",value:function(e,n){var r={};if("object"==("undefined"==typeof e?"undefined":c(e)))r=n[1]?t.withoutKeyObj(e,n[0]):n[0]?t.getKeyObj(e,n[0]):e;else{if("string"!=typeof e)return!1;r=e}return!r||$.isEmptyObject(r)?(console.error("参数为空"),!1):r}},{key:"setLocalData",value:function(e,t){window.db[e].items=t,window.localStorage.setItem("db",JSON.stringify(window.db))}},{key:"updateData",value:function(e,n,r){var o=window.db&&window.db[e].items;if(o&&o.size>0){var i=function(){var i=(0,f.List)(),u=(0,f.List)();return o.forEach(function(e,t){if(e[r]==n[r]){var a;!function(){var r=(0,f.Map)(e);for(a in n)r.map(function(e,t){t==a&&(u=r.set(a,n[a]))});var c=u.toObject();c.cacheTime=(new Date).getTime(),i=o.set(t,c)}()}}),i&&i.size>0?t.setLocalData(e,i):console.error("更改的数据不存在！"),{v:u.toObject()}}();if("object"===("undefined"==typeof i?"undefined":c(i)))return i.v}else console.error("更改的数据不存在！")}},{key:"removeData",value:function(e,n,r){var o=window.db&&window.db[e].items;if(o&&o.size>0){var i=(0,f.List)(),u=!1,a=void 0;return o.forEach(function(e,t){e[r]==n&&(u=!0,i=o.remove(t),a=e)}),u?t.setLocalData(e,i):console.error("删除的数据不存在！"),a}console.error("删除的数据不存在！")}},{key:"getKeyObj",value:function(e,n){if(e&&!t.isEmpty(e)&&n){var r={},o=[];n.constructor==String?o.push(n):n.constructor==Array&&(o=n);for(var i=0;i<o.length;i++){var u=o[i];f.Map.isMap(e)?void 0!=e.get(u)&&(r[u]=e.get(u)):e.constructor==Object?void 0!=e[u]&&(r[u]=e[u]):e.constructor==Array&&void 0!=e[0][u]&&(r[u]=e[0][u])}return r}}},{key:"getListKeyObj",value:function(e,n){if(e&&n){for(var r=[],o=0;o<e.length;o++){var i=this.getKeyObj(e[o],n);t.isEmpty(i)||r.push(i)}return r}}},{key:"filterListKey",value:function(e,n){if(e&&!t.isEmpty(e)&&n){return f.List.isList(e)?this.filterMapListKey(e,n):e.constructor==Array?this.filterMapListKey((0,f.List)(e),n):void 0}}},{key:"filterMapListKey",value:function(e,t){if(e&&t&&f.List.isList(e)){var n=(0,f.Map)(t),r=e.filter(function(e){var t=!0;return n.map(function(n,r){n!=(0,f.Map)(e).get(r)&&(t=!1)}),t});return r}}},{key:"withoutKeyObj",value:function(e,n){if(e&&!t.isEmpty(e)&&n){var r;if(f.Map.isMap(e))r=this.withoutMapKeyObj(e,n);else if(e.constructor==Object){var o=(0,f.Map)(e);r=this.withoutMapKeyObj(o,n)}else if(e.constructor==Array){r=[];for(var i=0;i<e.length;i++){var u=this.withoutMapKeyObj((0,f.Map)(e[i]),n);r.push(u)}}return r}}},{key:"withoutMapKeyObj",value:function(e,t){if(e&&t&&f.Map.isMap(e)){var n;if(t.constructor==String)n=e.filterNot(function(e,n){return t==n});else if(t.constructor==Array){var r=(0,f.List)(t);n=e.filterNot(function(e,t){return r.includes(t)})}return n.toObject()}}}]),t}(d["default"]);t["default"]=y},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(t,"__esModule",{value:!0});var u="function"==typeof Symbol&&"symbol"===i(Symbol.iterator)?function(e){return"undefined"==typeof e?"undefined":i(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":"undefined"==typeof e?"undefined":i(e)},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(7),l=r(c),f=function(){function e(t,n,r){if(o(this,e),!t||"object"!=("undefined"==typeof t?"undefined":u(t)))return void console.error("没有配置或者配置错误");window.collectionConfig=t,window.collectionI18n=n||"en","string"==typeof r?window.collectionMock=JSON.parse(r):window.collectionMock=r||{millis:34,code:"SUCCESS",message:"操作成功",entity:""};var i=window.localStorage.getItem("oldUrl")||"",a=!1;i.includes("mock")!=location.href.includes("mock")&&(a=!0,window.localStorage.setItem("oldUrl",location.href)),a&&window.localStorage.setItem("db","{}"),window.db={};var c=window.localStorage.getItem("db")||"{}";c=JSON.parse(c);for(var f in t){var s=!1;for(var d in c)d===f&&(s=!0);var y=[];s&&(y=c[f].items),window.db[f]=new l["default"](f,y)}}return a(e,[{key:"setCollectionI18n",value:function(e){window.collectionI18n=e||"en"}}]),e}();t["default"]=f},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(5),i=r(o);t["default"]={project:i["default"]}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]={findOne:{getUrl:function(e){return"/v2/project/"+e},returnChain:"entity.projectInfoList","return":{projectInfoList:[{projectId:"8c8c8ca956e00caa0156e8be040400dd",projectName:"来，跟我一起说：耶~",projectManager:"沈佳芳2233",projectManagerIcon:"https://file.newtouch.com/yangyang/131d4e16-6509-47d0-a46b-21c39480b89d.png",projectStatus:"14001",projectImportanceLevel:"41001",projectIcon:"https://file.newtouch.com/yangyang/item_logo_4.png",projectTagList:[{tagId:"wherwjfpwp1",systemFlag:"12"}],projectMember:["int"],members:1,projectManagerLoginName:"shenjiafang",projectNameSpace:"sjzmdqkk",projectNameForShirt:"sjzmd",projectCode:"wyqkk",commonFlag:"16001"}],closeProjectInfoList:[],commonProjectInfoList:null,regularProjectInfoList:null},structure:{time:64,code:"SUCCESS",message:"操作成功",entity:""},storeParam:"entity"},find:{getUrl:function(){return"v2/project/projectPage"},returnChain:"entity.projectInfoList",validate:6e4,fulldata:!0,"return":{joinNum:"",closeNum:"",closeProjectInfoList:[{projectId:"",projectImportanceLevel:"",commonFlag:"",members:"",projectCode:"",projectIcon:"",projectManager:"",projectManagerIcon:"",projectManagerLoginName:"",projectName:"",projectNameForShirt:"",projectNameSpace:"",projectStatus:"",projectTagList:""}],projectInfoList:[{projectId:"",projectImportanceLevel:"",commonFlag:"",members:"",projectCode:"",projectIcon:"",projectManager:"",projectManagerIcon:"",projectManagerLoginName:"",projectName:"",projectNameForShirt:"",projectNameSpace:"",projectStatus:"",projectTagList:""}]},structure:{time:64,code:"SUCCESS",message:"操作成功",entity:""},storeParam:"entity"},insert:{include:["projectName","projectNameShort","projectCode","projectNameSpace","fileListStr","importanceLevel"],exclusive:["projectId","projectName"],getUrl:function(e){return"v2/project"},"return":{projectId:32}},update:{include:["projectId","projectName"],exclusive:["projectId","projectName"],getUrl:function(e){return"v2/project/"+e},mockUrl:"mock/success.json"},remove:{getUrl:function(e){return"/v2/project/"+e}},entity:{primaryKey:"projectId",cacheTimeOut:5184e3,fields:{projectId:"string",projectName:"string",projectManager:"string",projectManagerIcon:"string",projectStatus:"string",projectImportanceLevel:"string",projectIcon:"string",members:"int",projectManagerLoginName:"string",projectNameSpace:"string",projectNameForShirt:"string",projectCode:"string",commonFlag:"string",createTime:"time",totalPrice:"money",tagId:"string",systemFlag:"int"}}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(1),f=n(13),s=r(f),d=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return u(t,e),c(t,null,[{key:"getList",value:function(e){return Array.isArray(e)?(0,l.List)(e):l.List.of()}},{key:"isMap",value:function(e){return l.Map.isMap(e)}},{key:"isList",value:function(e){return l.List.isList(e)}},{key:"getParamObj",value:function(e,n){var r={};if("object"==("undefined"==typeof e?"undefined":a(e)))r=n[1]?t.withoutKeyObj(e,n[0]):n[0]?t.getKeyObj(e,n[0]):e;else{if("string"!=typeof e)return!1;r=e}return!r||$.isEmptyObject(r)?(console.error("参数为空"),!1):r}},{key:"setLocalData",value:function(e,t){window.db[e].items=t,window.localStorage.setItem("db",JSON.stringify(window.db))}},{key:"updateData",value:function(e,n,r){var o=window.db&&window.db[e].items;if(o&&o.size>0){var i=function(){var i=(0,l.List)(),u=(0,l.List)();return o.forEach(function(e,t){if(e[r]==n[r]){var a;!function(){var r=(0,l.Map)(e);for(a in n)r.map(function(e,t){t==a&&(u=r.set(a,n[a]))});var c=u.toObject();c.cacheTime=(new Date).getTime(),i=o.set(t,c)}()}}),i&&i.size>0?t.setLocalData(e,i):console.error("更改的数据不存在！"),{v:u.toObject()}}();if("object"===("undefined"==typeof i?"undefined":a(i)))return i.v}else console.error("更改的数据不存在！")}},{key:"removeData",value:function(e,n,r){var o=window.db&&window.db[e].items;if(o&&o.size>0){var i=(0,l.List)(),u=!1,a=void 0;return o.forEach(function(e,t){e[r]==n&&(u=!0,i=o.remove(t),a=e)}),u?t.setLocalData(e,i):console.error("删除的数据不存在！"),a}console.error("删除的数据不存在！")}},{key:"getKeyObj",value:function(e,n){if(e&&!t.isEmpty(e)&&n){var r={},o=[];n.constructor==String?o.push(n):n.constructor==Array&&(o=n);for(var i=0;i<o.length;i++){var u=o[i];l.Map.isMap(e)?void 0!=e.get(u)&&(r[u]=e.get(u)):e.constructor==Object?void 0!=e[u]&&(r[u]=e[u]):e.constructor==Array&&void 0!=e[0][u]&&(r[u]=e[0][u])}return r}}},{key:"getListKeyObj",value:function(e,n){if(e&&n){for(var r=[],o=0;o<e.length;o++){var i=this.getKeyObj(e[o],n);t.isEmpty(i)||r.push(i)}return r}}},{key:"filterListKey",value:function(e,n){if(e&&!t.isEmpty(e)&&n){return l.List.isList(e)?this.filterMapListKey(e,n):e.constructor==Array?this.filterMapListKey((0,l.List)(e),n):void 0}}},{key:"filterMapListKey",value:function(e,t){if(e&&t&&l.List.isList(e)){var n=(0,l.Map)(t),r=e.filter(function(e){var t=!0;return n.map(function(n,r){n!=(0,l.Map)(e).get(r)&&(t=!1)}),t});return r}}},{key:"withoutKeyObj",value:function(e,n){if(e&&!t.isEmpty(e)&&n){var r;if(l.Map.isMap(e))r=this.withoutMapKeyObj(e,n);else if(e.constructor==Object){var o=(0,l.Map)(e);r=this.withoutMapKeyObj(o,n)}else if(e.constructor==Array){r=[];for(var i=0;i<e.length;i++){var u=this.withoutMapKeyObj((0,l.Map)(e[i]),n);r.push(u)}}return r}}},{key:"withoutMapKeyObj",value:function(e,t){if(e&&t&&l.Map.isMap(e)){var n;if(t.constructor==String)n=e.filterNot(function(e,n){return t==n});else if(t.constructor==Array){var r=(0,l.List)(t);n=e.filterNot(function(e,t){return r.includes(t)})}return n.toObject()}}}]),t}(s["default"]);t["default"]=d},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(t,"__esModule",{value:!0});var u="function"==typeof Symbol&&"symbol"===i(Symbol.iterator)?function(e){return"undefined"==typeof e?"undefined":i(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":"undefined"==typeof e?"undefined":i(e)},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(9),l=r(c),f=n(2),s=r(f),d=n(10),y=r(d),p=n(14),m=r(p),b=function(){function e(t,n){o(this,e),this.id=s["default"].uuid(),this.colName=t,this.items=s["default"].getList(n)}return a(e,[{key:"pubsub",value:function(e,t){m["default"].subscribe(this.pubsubKey(e),t)}},{key:"unsubscribe",value:function(e){m["default"].unsubscribe(this.pubsubKey(e))}},{key:"pubsubKey",value:function(e){return"collection."+this.colName+"."+e+"."+this.id}},{key:"findOne",value:function(t){var n=this;if(e.clearCacheData(this.colName,"findOne"),!l["default"].isMock)return l["default"].findOne(this.colName,t).then(function(e){m["default"].publish(n.pubsubKey("findOne"),e.nowItems)}.bind(this));var r=l["default"].findOne(this.colName,t);if(r){if("function"==typeof r.then)return r.then(function(e){m["default"].publish(n.pubsubKey("findOne"),e.nowItems)}.bind(this));m["default"].publish(this.pubsubKey("findOne"),r.nowItems)}}},{key:"find",value:function(t,n){var r=this;if(!t||"object"==!("undefined"==typeof t?"undefined":u(t)))return!1;var o={};for(var i in t){var a=t[i];if("object"!=("undefined"==typeof a?"undefined":u(a)))o[i]=a;else for(var c in a){var f=a[c];if(0!=c.indexOf("$"))return!1;var s=c;try{var d=y["default"][s](f);if(!d)return!1;o[i]=d}catch(p){return!1}}}if(e.clearCacheData(this.colName,"find"),!l["default"].isMock)return l["default"].find(this.colName,o,this).then(function(e){m["default"].publish(r.pubsubKey("find"),e.nowItems)}.bind(this));var b=l["default"].find(this.colName,t);if(b){if("function"==typeof b.then)return b.then(function(e){m["default"].publish(r.pubsubKey("find"),e.nowItems)}.bind(this));m["default"].publish(this.pubsubKey("find"),b.nowItems)}}},{key:"insert",value:function(t){var n=this;if(e.clearCacheData(this.colName,"insert"),!l["default"].isMock)return l["default"].insert(this.colName,t).then(function(e){m["default"].publish(n.pubsubKey("insert"),e.nowItems)}.bind(this));var r=l["default"].insert(this.colName,t);if(r){if("function"==typeof r.then)return r.then(function(e){m["default"].publish(n.pubsubKey("insert"),e.nowItems)}.bind(this));m["default"].publish(this.pubsubKey("insert"),r.nowItems)}}},{key:"update",value:function(t){var n=this;if(e.clearCacheData(this.colName,"update"),!l["default"].isMock)return l["default"].update(this.colName,t).then(function(e){m["default"].publish(n.pubsubKey("update"),e.nowItems)}.bind(this));var r=l["default"].update(this.colName,t);if(r){if("function"==typeof r.then)return r.then(function(e){m["default"].publish(n.pubsubKey("update"),e.nowItems)}.bind(this));m["default"].publish(this.pubsubKey("update"),r.nowItems)}}},{key:"remove",value:function(t){var n=this;if(e.clearCacheData(this.colName,"remove"),!l["default"].isMock)return l["default"].remove(this.colName,t).then(function(e){m["default"].publish(n.pubsubKey("remove"),e.nowItems)}.bind(this));var r=l["default"].remove(this.colName,t);if(r){if("function"==typeof r.then)return r.then(function(e){m["default"].publish(n.pubsubKey("remove"),e.nowItems)}.bind(this));m["default"].publish(this.pubsubKey("remove"),r.nowItems)}}}],[{key:"clearCacheData",value:function(e,t){var n=l["default"].getCacheTimeOut(e),r=(new Date).getTime(),o=window.db&&window.db[e].items.toArray(),i=[];for(var u in o){var a=o[u].cacheTime;n!=-1&&r-n>a&&i.push(u)}i=i.reverse();for(var u=0;u<i.length;u++)o.splice(i[u],1);s["default"].setLocalData(e,s["default"].getList(o))}}]),e}();t["default"]=b},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(t,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"===u(Symbol.iterator)?function(e){return"undefined"==typeof e?"undefined":u(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":"undefined"==typeof e?"undefined":u(e)},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(11),f=r(l),s=function(){function e(){i(this,e)}return c(e,null,[{key:"getKeyItems",value:function(e){var t=[];for(var n in e)t.push(n);return t}},{key:"mockUUID",value:function(t,n,r){if("object"===("undefined"==typeof t?"undefined":a(t))){var o=e.getKeyItems(t)[0],i=t[o].length||32,u="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678";return t[o]=e.getRandomString(i,u),n[r]=t,n}}},{key:"createMockContent",value:function(t,n){var r=JSON.parse(JSON.stringify(t));if("object"===("undefined"==typeof r?"undefined":a(r))){var i=function(){var t=e.getKeyItems(r),i=f["default"][e.mockLevel]||f["default"][e.level_1];return t.forEach(function(t,u){if($.isArray(r[t])){var c=[],l=e.getRandomlength(i.array);if("object"===a(r[t][0]))for(var f=0;f<l;f++){var s={};for(var d in r[t][0])s=$.extend(s,o({},d,e.getItemValue(n[d],i)));c.push(s)}else for(var f=0;f<l;f++)c.push(e.getItemValue(r[t][0],i));r[t]=c}else r[t]=e.getItemValue(n[t],i)}),{v:r}}();if("object"===("undefined"==typeof i?"undefined":a(i)))return i.v}}},{key:"getItemValue",value:function(t,n){var r="";if("string"===t){var o=window.collectionI18n;r=e.getSpecialItem(o,n[o])}else if("int"===t)r=e.getSpecialItem("int",n["int"]);else if("money"===t){var i=e.getSpecialItem("int",n["int"]);r=parseFloat(i/100).toFixed(2)}else"time"===t&&(r=(new Date).getTime());return r}},{key:"getRandomlength",value:function(e){if(e&&2==e.length){var t=e[1]-e[0]+1,n=Math.random();return e[0]+Math.round(n*t)}}},{key:"getRandomString",value:function(e,t){for(var n=t.length,r="",o=0;o<e;o++)r+=t.charAt(Math.floor(Math.random()*n));return r}},{key:"getSpecialItem",value:function(t,n){if(t&&n){if("int"==t){var r=e.getRandomlength(n),o="0123456789";return parseInt(e.getRandomString(r,o))}if("en"==t){var i=e.getRandomlength(n),u="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678";return e.getRandomString(i,u)}if("zh"==t){for(var a=new Array,c=e.getRandomlength(n),l=0;l<c;l++)a[l]=Math.round(20927*Math.random())+19968;var f=new Array;for(var l in a)f.push(String.fromCodePoint(a[l]));return f.join("")}}}}]),e}();s.level_1="level_1",s.level_2="level_2",s.level_3="level_3",s.mockLevel=function(){var e=location.href;if(e.includes("mock")){var t=e.indexOf("mock")+5,n=e.indexOf("&",t);return n<0&&(n=e.length),e.substring(t,n)||s.level_1}}(),t["default"]=s},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(8),c=r(a),l=n(2),f=r(l),s=n(1),d=function(){function e(){i(this,e)}return u(e,null,[{key:"isMockUrl",value:function(e,t){var n=window.collectionConfig[e],r=n&&n[t],o=r&&r.mockUrl||"";return o}},{key:"getStoreParam",value:function(e,t){var n=window.collectionConfig[e],r=n&&n[t],o=r&&r.storeParam||"entity";return o}},{key:"mock",value:function(t,n,r){var o=window.collectionConfig[t],i=o&&o[n],u=i&&i["return"],a=o&&o.entity&&o.entity.fields,l=i&&i.structure||{millis:32,code:"SUCCESS",message:"操作成功",entity:""},f=e.getStoreParam(t,n),s=e.getPrimaryKey(t);if(!u||$.isEmptyObject(u)){var d=e.isMockUrl(t,n);return d?d:window.collectionMock}if(u.hasOwnProperty(s)&&1==e.getObjLength(u))return c["default"].mockUUID(u,l,f);if(u&&a){var y=c["default"].createMockContent(u,a);return l[f]=y,l}}},{key:"getObjLength",value:function(e){var t=0;for(var n in e)t++;return t}},{key:"getUrl",value:function(e,t,n){var r=window.collectionConfig[e],o=r&&r[t];return o&&o.getUrl(n)}},{key:"getReturnChain",value:function(e,t){var n=window.collectionConfig[e],r=n&&n[t];return r&&r.returnChain}},{key:"getCacheTimeOut",value:function(e){var t=window.collectionConfig[e],n=t&&t.entity;return n&&n.cacheTimeOut}},{key:"getPrimaryKey",value:function(e){var t=window.collectionConfig[e],n=t&&t.entity;return n&&n.primaryKey}},{key:"getParamValue",value:function(e,t){if(!e||!t)return!1;var n=f["default"].getKeyObj(e,t);return n?n[t]:(console.error("找不到该key值"),!1)}},{key:"getPrimaryKeyValue",value:function(t,n){var r="";if("string"==typeof n)r=n;else{var o=e.getPrimaryKey(t);r=e.getParamValue(n,o)}return r?r:(console.error("找不到主键值"),!1)}},{key:"getNowdbData",value:function(t,n,r,o,i){var u=[],a=e.getStoreParam(t,r),c=o[a];if(n){var l=n.split(".");u=o;for(var f=0;f<l.length;f++)u=u[l[f]]}else if(c[i])u=c;else for(var f in c)c[f]&&c[f].length>0&&(u=c[f]);return"findOne"==r&&u&&u.length>0&&(u=u[0]),u}},{key:"isInsert",value:function(e,t,n,r){var o=!0,i=window.db&&window.db[e]&&window.db[e].items,u=(0,s.List)();return i&&i.size>0&&i.forEach(function(e,a){if(e[r]==n[r]&&(o=!1,"findOne"==t)){var c=$.extend({},e,n);u=i.set(a,c)}}),"findOne"==t?$.extend({isInsert:o},{extend:u}):o}},{key:"getDataKey",value:function(e,t){var n=window.collectionConfig[e];return n&&n[t]&&n[t].include?[n&&n[t]&&n[t].include,!1]:n&&n[t]&&n[t].exclusive?[n&&n[t]&&n[t].exclusive,!0]:["",!1]}},{key:"findOne",value:function(t,n){var r="findOne";if(e.isMock){var o=e.mock(t,r,n);return"string"==typeof o?$.getJSON(o,null,function(n){e.setFindOneData(t,r,n)}):e.setFindOneData(t,r,o)}var i=e.getPrimaryKeyValue(t,n);return $.get(e.getUrl(t,"findOne",i),null,function(n){"SUCCESS"===n.code&&e.setFindOneData(t,r,n)})}},{key:"setFindOneData",value:function(t,n,r){var o=e.getReturnChain(t,n),i=e.getPrimaryKey(t),u=e.getNowdbData(t,o,n,r,i);if(!u)return void console.error(t+"返回链"+o+"，配置有误！");u.cacheTime=(new Date).getTime();var a=e.isInsert(t,n,u,i),c=window.db&&window.db[t]&&window.db[t].items;a.isInsert&&c&&f["default"].setLocalData(t,window.db[t].items.push(u)),!a.isInsert&&c&&f["default"].setLocalData(t,a.extend);var l=new Array(u);return r.nowItems=(0,s.List)(l),r}},{key:"find",value:function(t,n,r){var o="find";if(e.isMock){var i=e.mock(t,o,n);return"string"==typeof i?$.getJSON(i,null,function(n){e.setFindData(t,o,n)}):e.setFindData(t,o,i)}return $.get(e.getUrl(t,o,n),n,function(n){"SUCCESS"===n.code&&e.setFindData(t,o,n)})}},{key:"setFindData",value:function(t,n,r){var o=e.getReturnChain(t,n),i=e.getPrimaryKey(t),u=e.getNowdbData(t,o,n,r,i);if(!u)return void console.error(t+"返回链"+o+"，配置有误！");var a=window.db&&window.db[t]&&window.db[t].items;if(a&&a.size>0){var c=(0,s.List)();for(var l in u){var d=!0;a=c.size>0?c:a,a.forEach(function(e,t){u[l].cacheTime=(new Date).getTime(),e[i]==u[l][i]&&(d=!1,c=a.set(t,u[l]))}),d?f["default"].setLocalData(t,window.db[t].items.push(u[l])):f["default"].setLocalData(t,c)}}else if(a)for(var y in u)u[y].cacheTime=(new Date).getTime(),f["default"].setLocalData(t,window.db[t].items.push(u[y]));return r.nowItems=(0,s.List)(u),r}},{key:"insert",value:function(t,n){var r="insert",o=e.getDataKey(t,r),i=f["default"].getParamObj(n,o);if(e.isMock){var u=e.mock(t,r,n);return"string"==typeof u?$.getJSON(u,null,function(n){e.setInsertData(t,r,n,i)}):e.setInsertData(t,r,u,i)}return $.post(e.getUrl(t,r,n),i,function(n){"SUCCESS"===n.code&&e.setInsertData(t,r,n,i)})}},{key:"setInsertData",value:function(t,n,r,i){var u=e.getPrimaryKey(t),a=e.getStoreParam(t,n),c=r[a],l=e.isInsert(t,n,c,u);if(l){var f=$.extend({cacheTime:(new Date).getTime()},i,o({},u,c[u])),d=window.db&&window.db[t]&&window.db[t].items;d&&(window.db[t].items=window.db[t].items.push(f),window.localStorage.setItem("db",JSON.stringify(window.db)));var y=new Array(f);return r.nowItems=(0,s.List)(y),r}console.error("已存在此数据，不能重复新建！")}},{key:"update",value:function(t,n){var r="update";if(e.isMock){var o=e.mock(t,r,n);return"string"==typeof o?$.getJSON(o,null,function(o){e.setUpdateData(t,r,o,n)}):e.setUpdateData(t,r,o,n)}var i=e.getDataKey(t,r),u=f["default"].getParamObj(n,i),a=e.getPrimaryKeyValue(t,n);return $.put(e.getUrl(t,r,a),u,function(o){"SUCCESS"===o.code&&e.setUpdateData(t,r,o,n)})}},{key:"setUpdateData",value:function(t,n,r,o){var i=e.getPrimaryKey(t),u=e.getStoreParam(t,n),a=r[u];if(a&&a.length>0){var c=new Array(f["default"].updateData(t,a,i));return r.nowItems=(0,s.List)(c),r}var l=new Array(f["default"].updateData(t,o,i));return r.nowItems=(0,s.List)(l),r}},{key:"remove",value:function(t,n){var r="remove",o=e.getPrimaryKey(t),i=e.getPrimaryKeyValue(t,n);
if(e.isMock){var u=e.mock(t,r,n);if("string"==typeof u)return $.getJSON(u,null,function(e){var n=new Array(f["default"].removeData(t,i,o));e.nowItems=(0,s.List)(n)});var a=new Array(f["default"].removeData(t,i,o));return u.nowItems=(0,s.List)(a),u}return $["delete"](e.getUrl(t,r,i),null,function(e){if("SUCCESS"===e.code){var n=new Array(f["default"].removeData(t,i,o));e.nowItems=(0,s.List)(n)}})}}]),e}();d.initJquery=function(){$.ajaxSetup({cache:!1}),$(document).ajaxSend(function(e,t,n){}),$(document).ajaxSuccess(function(e,t,n){}),$(document).ajaxError(function(e,t,n,r){}),jQuery.each(["put","delete"],function(e,t){jQuery[t]=function(e,n,r,o){return jQuery.isFunction(n)&&(o=o||r||"json",r=n,n=void 0),jQuery.ajax({url:e,type:t,dataType:o,data:n,success:r})}})}(),d.isMock=function(){var e=!1,t=location.href;return t.includes("mock")&&(e=!0),e}(),t["default"]=d},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(){n(this,e)}return r(e,null,[{key:"$in",value:function(e){return!!Array.isArray(e)&&e.toString()}}]),e}();t["default"]=o},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]={level_1:{en:[5,50],zh:[1,20],"int":[1,10],array:[0,20]},level_2:{en:[50,100],zh:[20,80],"int":[10,20],array:[20,80]},level_3:{en:[100,200],zh:[80,150],"int":[20,100],array:[80,150]}}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(t,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"===o(Symbol.iterator)?function(e){return"undefined"==typeof e?"undefined":o(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":"undefined"==typeof e?"undefined":o(e)},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=(n(1),function(){function e(){r(this,e)}return u(e,null,[{key:"pushPollFuns",value:function(t){var n=t;"object"===("undefined"==typeof t?"undefined":i(t))&&(n=t.func),"function"==typeof n&&e.pollFuns.push(t)}},{key:"getKey",value:function(t){var n=(t||"key")+"_";return e.key=e.key+1,n+e.key}},{key:"uuid",value:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,n="x"==e?t:3&t|8;return n.toString(16)})}},{key:"isEmpty",value:function(e){if(!e)return!0;if(this.isArray(e))return 0==e.length;if(this.isObject(e)){for(var t in e)return!1;return!0}return!1}},{key:"isObject",value:function(e){var t="undefined"==typeof e?"undefined":i(e);return"function"===t||"object"===t&&!!e}},{key:"isArray",value:function(e){return Array.isArray(e)||"[object Array]"===toString.call(e)}}]),e}());a.pollFuns=[],a.poll=function(){setInterval(function(){for(var e in a.pollFuns){var t=a.pollFuns[e];"function"==typeof t?t():(t.cur=(t.cur||t.delay)-1,t.cur<1&&("function"==typeof t.func&&t.func(),t.cur=t.delay))}},1e3)}(),a.key=0,t["default"]=a},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=(n(1),function(){function e(){r(this,e)}return i(e,null,[{key:"pushPollFuns",value:function(t){var n=t;"object"===("undefined"==typeof t?"undefined":o(t))&&(n=t.func),"function"==typeof n&&e.pollFuns.push(t)}},{key:"getKey",value:function(t){var n=(t||"key")+"_";return e.key=e.key+1,n+e.key}},{key:"uuid",value:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,n="x"==e?t:3&t|8;return n.toString(16)})}},{key:"isEmpty",value:function(e){if(!e)return!0;if(this.isArray(e))return 0==e.length;if(this.isObject(e)){for(var t in e)return!1;return!0}return!1}},{key:"isObject",value:function(e){var t="undefined"==typeof e?"undefined":o(e);return"function"===t||"object"===t&&!!e}},{key:"isArray",value:function(e){return Array.isArray(e)||"[object Array]"===toString.call(e)}}]),e}());u.pollFuns=[],u.poll=function(){setInterval(function(){for(var e in u.pollFuns){var t=u.pollFuns[e];"function"==typeof t?t():(t.cur=(t.cur||t.delay)-1,t.cur<1&&("function"==typeof t.func&&t.func(),t.cur=t.delay))}},1e3)}(),u.key=0,t["default"]=u},function(e,t){e.exports=PubSub},function(e,t){e.exports=React},function(e,t){e.exports=ReactDOM}]);
//# sourceMappingURL=bundle.js.map